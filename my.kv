WindowManager:
    Login:
    MainWindow:
    JournalWindow:
    HistoryWindow:
    NegativityPebbleApp:

<Login>:
    name: "login"
    entry: entry  # Bind the ObjectProperty to the TextInput

    FloatLayout
        Image:
            source: 'assets/bg-login.png' 
            size: self.size
            pos: self.pos
            allow_stretch: True
            keep_ratio: False
        Image:
            source: 'assets/logo.png'
            size_hint: 0.66, 0.33
            pos_hint: {'center_x': 0.5, 'center_y': 0.72}
        Label:
            text: "Input your user id"
            color: 0.4, 0.2, 0.1, 1
            font_name: 'font'
            font_size: '30sp'
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        TextInput:
            id: entry
            multiline: False
            font_name: 'font'
            font_size: '30sp'
            size_hint: (0.3, 0.1)
            pos_hint: {'center_x': 0.5, 'center_y': 0.4}

        Button:
            text: "Submit"
            font_name: 'font'
            font_size: '30sp'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.2, 0.1)
            pos_hint: {'center_x': 0.5, 'center_y': 0.25}
            on_press:
                root.save_btn_press()
                app.root.current = "main"
                root.manager.transition.direction = "up"

<MainWindow>:
    name: "main"
    
    FloatLayout:
        Image:
            source: 'assets/bg-main.png' 
            size: self.size
            pos: self.pos
            allow_stretch: True
            keep_ratio: False

        Image:
            source:'assets/text-main-yourgreenhouse.png'
            size_hint: 0.66, 0.33
            pos_hint: {'center_x': 0.5, 'center_y': 0.75}

        Label:
            text: root.point_txt
            font_size: '40sp'
            font_name: 'font'
            color: 0.4, 0.2, 0.1, 1
            pos_hint: {'center_x': 0.85, 'center_y': 0.90}
        
        # Label:
        #     text: root.streak_txt
        #     font_size: '40sp'
        #     font_name: 'font'
        #     color: 0.4, 0.2, 0.1, 1
        #     pos_hint: {'center_x': 0.15, 'center_y': 0.90}

        Button:
            text: "New Entry"
            font_name: 'font'
            font_size: '30sp'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.2, 0.1)
            pos_hint: {'center_x': 0.2, 'center_y': 0.1}
            on_release:
                app.root.current = "journal"
                root.manager.transition.direction = "left"
        
        Button:
            text: "Negativity Pebble"
            font_name: 'font'
            font_size: '30sp'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.22, 0.1)
            pos_hint: {'center_x': 0.5, 'center_y': 0.1}
            on_release:
                app.root.current = "negativitypebble"
                root.manager.transition.direction = "left"

        Button:
            text: "Previous Entries"
            font_name: 'font'
            font_size: '30sp'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.22, 0.1)
            pos_hint: {'center_x': 0.8, 'center_y': 0.1}
            on_release:
                app.root.current = "history"
                root.manager.transition.direction = "left"
        
        Button:
            btn_id: 1
            size_hint: None, None
            size: '180dp', '180dp'
            pos_hint: {'center_x': 0.2, 'center_y': 0.32}
            background_normal: 'assets/img-main-pot.png'
            on_press: root.flower_pot_press(self)

        Image:
            id: flower1
            source: 'assets/img-placeholder.png'  
            size_hint: None, None
            size: '400dp', '400dp'
            pos_hint: {'center_x': 0.2, 'center_y': 0.5}
            pos: 100, 100

        Button:
            btn_id: 2
            size_hint: None, None
            size: '180dp', '180dp'
            pos_hint: {'center_x': 0.5, 'center_y': 0.32}
            background_normal: 'assets/img-main-pot.png'   
            on_press: root.flower_pot_press(self)
        
        Image:
            id: flower2
            source: 'assets/img-placeholder.png'  
            size_hint: None, None
            size: '400dp', '400dp'
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        
        Button:
            btn_id: 3
            size_hint: None, None
            size: '180dp', '180dp'
            pos_hint: {'center_x': 0.8, 'center_y': 0.32}
            background_normal: 'assets/img-main-pot.png'   
            on_press: root.flower_pot_press(self)
        
        Image:
            id: flower3
            source: 'assets/img-placeholder.png'  
            size_hint: None, None
            size: '400dp', '400dp'
            pos_hint: {'center_x': 0.8, 'center_y': 0.5}

        Button:
            text: "logout"
            font_size: '30sp'
            font_name: 'font.ttf'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            pos_hint: {'center_x':0.5, 'center_y':0.9}
            size_hint: 0.1, 0.1
            on_release:
                app.root.current = "login"
                root.manager.transition.direction = "down"
            
<JournalWindow>:
    name: "journal"
    entry: entry

    FloatLayout:
        Image:
            source: 'assets/bg-journal.png'
            size: self.size
            pos: self.pos
            allow_stretch: True
            keep_ratio: False

        Label:
            text: root.feeling_label_text
            size_hint: (0.2, 0.5)
            text_size: self.width, None
            halign: 'center'
            valign: 'middle'
            multiline: True
            color: 0.4, 0.2, 0.1, 1
            font_name: 'font'
            font_size: '20sp'
            pos_hint: {'center_x': 0.33, 'center_y': 0.55}
        
        TextInput:
            id: entry
            hint_text: "start writing..."
            text_color: 0.4, 0.2, 0.1, 1
            multiline: True
            font_name: 'font'
            font_size: '15sp'
            size_hint: (0.2, 0.5)
            pos_hint: {'center_x': 0.65, 'center_y': 0.5}
            background_color: 0,0,0,0

        Button:
            text: "Back"
            font_name: 'font'
            font_size: '20sp'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.125, 0.1)
            pos_hint: {'center_x': 0.35, 'center_y': 0.2}
            on_press:
                app.root.current = "main"
                root.manager.transition.direction = "right"

        Button:
            text: "Ask"
            
            font_name: 'font'
            font_size: '20sp'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.125, 0.1)
            pos_hint: {'center_x': 0.5, 'center_y': 0.2}
            on_press:
                root.ask_btn_press()

        Button:
            text: "Finish"
            font_name: 'font'
            font_size: '20sp'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.125, 0.1)
            pos_hint: {'center_x': 0.65, 'center_y': 0.2}
            on_press:
                root.save_btn_press()
            on_release:
                app.root.current = "main"
                root.manager.transition.direction = "right"

<HistoryWindow>:
    name: "history"
    entries: entries

    FloatLayout:
        Image:
            source: 'assets/bg-history.png' 
            size: self.size
            pos: self.pos
            allow_stretch: True
            keep_ratio: False
    
        Button:
            text: "Refresh Entries"
            font_size: '25sp'
            font_name: 'font.ttf'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            size_hint: (0.5, 0.1)
            pos_hint: {'center_x': 0.5, 'center_y': 0.85}
            on_press:
                root.add_labels()

        MDScrollView:
            size_hint: (0.34, 0.5)
            font_name: 'font'
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}

            MDList:
                id: entries

        Button:
            text: "Back"
            font_name: 'font.ttf'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            font_size: '30sp'
            size_hint: (0.2, 0.1)
            pos_hint: {'center_x': 0.5, 'center_y': 0.15}
            on_release:
                app.root.current = "main"
                root.manager.transition.direction = "right"


<NegativityPebbleApp>:
    name: "negativitypebble"
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'assets/bg-pebble.webp'
        
    FloatLayout:
        Image:
            source: 'assets/bg-pebble.webp'
            allow_stretch: True
            keep_ratio: False
            size_hint: 1,1
        
        Label:
            id: heading
            text: 'Negativity Pebble'
            font_size: 63
            font_name: 'font.ttf'
            pos_hint: {'center_x': 0.5, 'center_y': 0.8}
            color: 0.4, 0.2, 0.1, 1
        
        Label:
            id: message
            text: 'Your negative thought has been thrown into the pond!'
            text_size: self.width, None
            font_size: 30
            size_hint_y: None
            font_name: 'font.ttf'
            pos_hint: {'center_x': 0.5, 'center_y':0.5}
            color: 0.4, 0.2, 0.1, 1
            halign:'center'
            opacity: 0

        Image:
            id: pebble
            source: 'assets/img-pebble-chomp.png'
            size_hint: 0.3, 0.3
            pos_hint: {'center_x':.5, 'center_y':.5}
            opacity: 1 
            allow_stretch: True
            keep_ratio: False
        Image:
            id: chew
            source: 'assets/img-pebble-chew.png'
            size_hint: 0.3, 0.3
            pos_hint: {'center_x':.5, 'center_y':.5}
            opacity: 0 
            allow_stretch: True
            keep_ratio: False

        TextInput:
            id: negative_message
            hint_text: "Write down a negative thought"
            size_hint: 0.2, 0.1
            pos_hint: {'center_x':.5, 'center_y':.46}
            multiline: False
            font_size: 25
            font_name: 'font.ttf'
            background_color: 0,0,0,0
    
        Button:
            id: throw_button
            text: 'throw!'
            font_size: 35
            font_name: 'font.ttf'
            on_press: root.throw_action()
            on_release: root.add_points()
            size_hint: 0.2, 0.1
            pos_hint: {'center_x':.5, 'center_y':.2}
            # pos: 400, 80
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1

        Button:
            text: "Back"
            font_size: 30
            font_name: 'font.ttf'
            color: 1, 1, 0.8, 1
            background_color: 1, 0.5, 0.259,1
            pos_hint: {'center_x':0.95, 'center_y':0.95}
            size_hint: 0.1, 0.1
            on_release:
                app.root.current = "main"
                root.manager.transition.direction = "right"


<P>:
    Label:
        text: "You are about to delete an entry! Click elsewhere to dismiss."
        size_hint: 0.6, 0.2
        pos_hint: {"x":0.2, "top":1}

    Button:
        text: "Confirm"
        size_hint: 0.8, 0.2
        pos_hint: {"x":0.1, "y":0.1}
        on_release: root.delete_entry()